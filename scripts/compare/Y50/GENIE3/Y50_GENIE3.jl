using CSV
using DataFrames
using CartesianGeneticProgramming

function get_expect()
    res = Set()
    push!(res, "YCL066W_YKL178C")
    push!(res, "YCL067C_YCL066W")
    push!(res, "YCL067C_YGR044C")
    push!(res, "YCR040W_YKL178C")
    push!(res, "YCR096C_YCR039C")
    push!(res, "YCR096C_YCR040W")
    push!(res, "YCR096C_YKL178C")
    push!(res, "YCR097W_YCL066W")
    push!(res, "YCR097W_YCR039C")
    push!(res, "YCR097W_YCR040W")
    push!(res, "YCR097W_YGR044C")
    push!(res, "YCR097W_YKL178C")
    push!(res, "YDR146C_YBL111C")
    push!(res, "YDR146C_YCR018C")
    push!(res, "YDR146C_YDR543C")
    push!(res, "YDR146C_YDR545W")
    push!(res, "YDR146C_YER188CA")
    push!(res, "YDR146C_YER189W")
    push!(res, "YDR146C_YER190W")
    push!(res, "YDR146C_YGR044C")
    push!(res, "YDR146C_YGR296W")
    push!(res, "YDR146C_YLR013W")
    push!(res, "YDR146C_YMR135WA")
    push!(res, "YDR146C_YNL336W")
    push!(res, "YDR146C_YOR140W")
    push!(res, "YDR146C_YPL283C")
    push!(res, "YDR421W_YCL065W")
    push!(res, "YDR421W_YCL066W")
    push!(res, "YDR421W_YCL067C")
    push!(res, "YGL035C_YBR019C")
    push!(res, "YGL035C_YBR020W")
    push!(res, "YGL035C_YDR009W")
    push!(res, "YGL035C_YDR146C")
    push!(res, "YGL035C_YKL109W")
    push!(res, "YGL035C_YMR280C")
    push!(res, "YGL035C_YPL248C")
    push!(res, "YGL209W_YBR019C")
    push!(res, "YGL209W_YBR020W")
    push!(res, "YGL209W_YDR009W")
    push!(res, "YGL209W_YDR146C")
    push!(res, "YGL209W_YGL035C")
    push!(res, "YGL209W_YKL109W")
    push!(res, "YGL209W_YMR280C")
    push!(res, "YGL209W_YPL248C")
    push!(res, "YGR044C_YCR018C")
    push!(res, "YGR044C_YOR140W")
    push!(res, "YHR006W_YCR039C")
    push!(res, "YHR006W_YCR040W")
    push!(res, "YHR006W_YCR041W")
    push!(res, "YJL056C_YCL065W")
    push!(res, "YJL056C_YCL066W")
    push!(res, "YJL056C_YCL067C")
    push!(res, "YJL056C_YCR039C")
    push!(res, "YJL056C_YCR040W")
    push!(res, "YJL056C_YCR041W")
    push!(res, "YJL056C_YDR545W")
    push!(res, "YJL056C_YER188CA")
    push!(res, "YJL056C_YER189W")
    push!(res, "YJL056C_YNL336W")
    push!(res, "YJL056C_YNL337W")
    push!(res, "YJL056C_YNL339C")
    push!(res, "YJL110C_YBL111C")
    push!(res, "YJL110C_YCL065W")
    push!(res, "YJL110C_YCL066W")
    push!(res, "YJL110C_YCL067C")
    push!(res, "YJL110C_YCR039C")
    push!(res, "YJL110C_YCR040W")
    push!(res, "YJL110C_YCR041W")
    push!(res, "YJL110C_YCR096C")
    push!(res, "YJL110C_YDR543C")
    push!(res, "YJL110C_YDR544C")
    push!(res, "YJL110C_YDR545W")
    push!(res, "YJL110C_YER189W")
    push!(res, "YJL110C_YER190W")
    push!(res, "YJL110C_YGL001C")
    push!(res, "YJL110C_YGR296W")
    push!(res, "YJL110C_YHR091C")
    push!(res, "YJL110C_YLR463C")
    push!(res, "YJL110C_YLR465C")
    push!(res, "YJL110C_YLR467W")
    push!(res, "YJL110C_YNL337W")
    push!(res, "YJL110C_YNL339C")
    push!(res, "YKL109W_YBL111C")
    push!(res, "YKL109W_YCL065W")
    push!(res, "YKL109W_YCL066W")
    push!(res, "YKL109W_YCL067C")
    push!(res, "YKL109W_YCR039C")
    push!(res, "YKL109W_YCR040W")
    push!(res, "YKL109W_YCR041W")
    push!(res, "YKL109W_YDR543C")
    push!(res, "YKL109W_YDR544C")
    push!(res, "YKL109W_YDR545W")
    push!(res, "YKL109W_YER188CA")
    push!(res, "YKL109W_YER189W")
    push!(res, "YKL109W_YGL001C")
    push!(res, "YKL109W_YGR296W")
    push!(res, "YKL109W_YHR091C")
    push!(res, "YKL109W_YLR463C")
    push!(res, "YKL109W_YLR465C")
    push!(res, "YKL109W_YLR467W")
    push!(res, "YKL109W_YNL336W")
    push!(res, "YKL109W_YNL337W")
    push!(res, "YKL109W_YNL339C")
    push!(res, "YKL109W_YPL283C")
    push!(res, "YLR013W_YBL111C")
    push!(res, "YLR013W_YCL065W")
    push!(res, "YLR013W_YCL066W")
    push!(res, "YLR013W_YCL067C")
    push!(res, "YLR013W_YCR039C")
    push!(res, "YLR013W_YCR040W")
    push!(res, "YLR013W_YCR041W")
    push!(res, "YLR013W_YDR543C")
    push!(res, "YLR013W_YDR544C")
    push!(res, "YLR013W_YDR545W")
    push!(res, "YLR013W_YER188CA")
    push!(res, "YLR013W_YER189W")
    push!(res, "YLR013W_YGR296W")
    push!(res, "YLR013W_YHR091C")
    push!(res, "YLR013W_YLR463C")
    push!(res, "YLR013W_YLR465C")
    push!(res, "YLR013W_YLR467W")
    push!(res, "YLR013W_YNL336W")
    push!(res, "YLR013W_YNL337W")
    push!(res, "YLR013W_YNL339C")
    push!(res, "YLR013W_YPL283C")
    push!(res, "YLR098C_YCL065W")
    push!(res, "YLR098C_YCL066W")
    push!(res, "YLR098C_YCL067C")
    push!(res, "YLR098C_YCR039C")
    push!(res, "YLR098C_YCR040W")
    push!(res, "YLR098C_YCR041W")
    push!(res, "YLR098C_YER189W")
    push!(res, "YLR098C_YER190W")
    push!(res, "YLR098C_YMR135WA")
    push!(res, "YML051W_YBR019C")
    push!(res, "YML051W_YBR020W")
    push!(res, "YML113W_YCR096C")
    push!(res, "YML113W_YDR543C")
    push!(res, "YML113W_YDR544C")
    push!(res, "YML113W_YDR545W")
    push!(res, "YML113W_YER189W")
    push!(res, "YML113W_YER190W")
    push!(res, "YML113W_YGL001C")
    push!(res, "YML113W_YGR296W")
    push!(res, "YML113W_YHR091C")
    push!(res, "YML113W_YLR463C")
    push!(res, "YML113W_YLR465C")
    push!(res, "YML113W_YLR467W")
    push!(res, "YML113W_YNL337W")
    push!(res, "YML113W_YNL339C")
    push!(res, "YML113W_YPL283C")
    push!(res, "YOL089C_YCR096C")
    push!(res, "YOL089C_YCR097W")
    push!(res, "YOL089C_YGL001C")
    push!(res, "YOL089C_YNL336W")
    push!(res, "YOL089C_YNL337W")
    push!(res, "YOL089C_YNL339C")
    push!(res, "YOR032C_YGL001C")
    push!(res, "YOR032C_YHR006W")
    push!(res, "YPL248C_YBL111C")
    push!(res, "YPL248C_YBR019C")
    push!(res, "YPL248C_YBR020W")
    push!(res, "YPL248C_YCL065W")
    push!(res, "YPL248C_YCL066W")
    push!(res, "YPL248C_YCL067C")
    push!(res, "YPL248C_YDR009W")
    push!(res, "YPL248C_YDR544C")
    push!(res, "YPL248C_YDR545W")
    push!(res, "YPL248C_YER188CA")
    push!(res, "YPL248C_YER189W")
    push!(res, "YPL248C_YER190W")
    push!(res, "YPL248C_YGR296W")
    push!(res, "YPL248C_YHR091C")
    push!(res, "YPL248C_YML051W")
    push!(res, "YPL248C_YMR135WA")
    push!(res, "YPL248C_YNL336W")
    push!(res, "YPL248C_YNL337W")
    push!(res, "YPL248C_YNL339C")
    push!(res, "YPL248C_YOR140W")
    push!(res, "YPR199C_YCR039C")
    push!(res, "YPR199C_YCR040W")
    push!(res, "YPR199C_YCR041W")
    push!(res, "YPR199C_YCR096C")
    push!(res, "YPR199C_YMR135WA")    
    res
end

function get_actual()
    res = Set()
    push!(res, "YLR013W_YCL066W")
    push!(res, "YBR020W_YGL035C")
    push!(res, "YOL089C_YPL248C")
    push!(res, "YPL248C_YOL089C")
    push!(res, "YOL089C_YCR097W")
    push!(res, "YLR013W_YLR463C")
    push!(res, "YDR146C_YBR020W")
    push!(res, "YGL209W_YMR280C")
    push!(res, "YGR296W_YDR544C")
    push!(res, "YCR097W_YKL178C")
    push!(res, "YKL109W_YNL336W")
    push!(res, "YMR280C_YGL209W")
    push!(res, "YGL035C_YBR020W")
    push!(res, "YNL336W_YKL109W")
    push!(res, "YDR421W_YDR009W")
    push!(res, "YOL089C_YOR140W")
    push!(res, "YCR041W_YOR032C")
    push!(res, "YCR097W_YOL089C")
    push!(res, "YDR543C_YDR421W")
    push!(res, "YLR013W_YMR135WA")
    push!(res, "YCR018C_YLR013W")
    push!(res, "YDR421W_YDR543C")
    push!(res, "YCL066W_YDR544C")
    push!(res, "YDR146C_YCR018C")
    push!(res, "YBR020W_YDR146C")
    push!(res, "YCR018C_YHR091C")
    push!(res, "YCR018C_YDR146C")
    push!(res, "YDR009W_YDR421W")
    push!(res, "YGL001C_YOL089C")
    push!(res, "YKL109W_YBL111C")
    push!(res, "YDR146C_YBR019C")
    push!(res, "YLR098C_YOR032C")
    push!(res, "YPL283C_YKL109W")
    push!(res, "YBL111C_YKL109W")
    push!(res, "YOR032C_YJL110C")
    push!(res, "YOR032C_YLR098C")
    push!(res, "YOL089C_YGL001C")
    push!(res, "YCR041W_YLR098C")
    push!(res, "YMR280C_YER189W")
    push!(res, "YGL035C_YDR146C")
    push!(res, "YDR146C_YLR013W")
    push!(res, "YLR013W_YDR146C")
    push!(res, "YCL065W_YLR463C")
    push!(res, "YBR020W_YLR013W")
    push!(res, "YER189W_YGL209W")
    push!(res, "YDR544C_YGR296W")
    push!(res, "YDR146C_YGL035C")
    push!(res, "YCR018C_YNL336W")
    push!(res, "YML113W_YER188CA")
    push!(res, "YLR013W_YNL339C")
    push!(res, "YLR013W_YCR018C")
    push!(res, "YCL066W_YLR013W")
    push!(res, "YGR296W_YGL001C")
    push!(res, "YJL110C_YOR032C")
    push!(res, "YER189W_YMR280C")
    push!(res, "YDR543C_YDR544C")
    push!(res, "YMR135WA_YLR013W")
    push!(res, "YGL001C_YPL248C")
    push!(res, "YCL066W_YLR465C")
    push!(res, "YCR097W_YCR039C")
    push!(res, "YER188CA_YML113W")
    push!(res, "YER190W_YER188CA")
    push!(res, "YBR020W_YBR019C")
    push!(res, "YOL089C_YCR040W")
    push!(res, "YOR140W_YOL089C")
    push!(res, "YGR044C_YCR018C")
    push!(res, "YER188CA_YER190W")
    push!(res, "YDR146C_YML113W")
    push!(res, "YBR019C_YBR020W")
    push!(res, "YLR465C_YBL111C")
    push!(res, "YHR091C_YCR018C")
    push!(res, "YHR091C_YPL283C")
    push!(res, "YOR032C_YCR041W")
    push!(res, "YCR040W_YGL035C")
    push!(res, "YPL283C_YBL111C")
    push!(res, "YDR421W_YCL067C")
    push!(res, "YGL209W_YER189W")
    push!(res, "YCL066W_YBL111C")
    push!(res, "YPL248C_YGL001C")
    push!(res, "YDR421W_YGR044C")
    push!(res, "YLR013W_YBR020W")
    push!(res, "YPL248C_YCR097W")
    push!(res, "YNL337W_YNL339C")
    push!(res, "YDR146C_YDR009W")
    push!(res, "YLR098C_YCR041W")
    push!(res, "YPL283C_YNL337W")
    push!(res, "YBR020W_YMR280C")
    push!(res, "YGR044C_YMR135WA")
    push!(res, "YNL337W_YPL283C")
    push!(res, "YCR040W_YCR018C")
    push!(res, "YLR013W_YGL035C")
    push!(res, "YGR044C_YCR097W")
    push!(res, "YCR018C_YMR135WA")
    push!(res, "YCR040W_YGR296W")
    push!(res, "YDR544C_YCL066W")
    push!(res, "YOR140W_YPL248C")
    push!(res, "YCL065W_YDR545W")
    push!(res, "YLR013W_YLR465C")
    push!(res, "YGL035C_YCR040W")
    push!(res, "YCR018C_YGR044C")
    push!(res, "YKL178C_YCR097W")
    push!(res, "YBR019C_YDR146C")
    push!(res, "YCL067C_YER190W")
    push!(res, "YGL001C_YGR296W")
    push!(res, "YDR543C_YCL067C")
    push!(res, "YBR019C_YGL209W")
    push!(res, "YDR146C_YHR091C")
    push!(res, "YKL178C_YCR039C")
    push!(res, "YDR544C_YDR543C")
    push!(res, "YGR044C_YKL178C")
    push!(res, "YCR040W_YPR199C")
    push!(res, "YPL283C_YJL110C")
    push!(res, "YBL111C_YDR009W")
    push!(res, "YOR032C_YHR006W")
    push!(res, "YDR421W_YCL065W")
    push!(res, "YDR421W_YOR140W")
    push!(res, "YDR009W_YCL067C")
    push!(res, "YLR013W_YBR019C")
    push!(res, "YDR421W_YDR544C")
    push!(res, "YER190W_YML113W")
    push!(res, "YGL035C_YLR013W")
    push!(res, "YBR020W_YGL209W")
    push!(res, "YPL248C_YOR140W")
    push!(res, "YCR040W_YDR009W")
    push!(res, "YCL067C_YDR543C")
    push!(res, "YBR019C_YMR280C")
    push!(res, "YPL283C_YPR199C")
    push!(res, "YCR097W_YGR044C")
    push!(res, "YGR044C_YDR543C")
    push!(res, "YOR140W_YCR039C")
    push!(res, "YGL035C_YCL065W")
    push!(res, "YLR013W_YCL065W")
    push!(res, "YJL110C_YPL283C")
    push!(res, "YHR091C_YNL339C")
    push!(res, "YNL337W_YCL065W")
    push!(res, "YGR044C_YLR013W")
    push!(res, "YLR098C_YMR280C")
    push!(res, "YPL283C_YKL178C")
    push!(res, "YLR463C_YDR545W")
    push!(res, "YHR091C_YKL178C")
    push!(res, "YBR019C_YLR463C")
    push!(res, "YKL109W_YPL283C")
    push!(res, "YCR039C_YCR097W")
    push!(res, "YGL035C_YBR019C")
    push!(res, "YLR013W_YDR544C")
    push!(res, "YGR296W_YLR467W")
    push!(res, "YPL248C_YER189W")
    push!(res, "YPL283C_YDR421W")
    push!(res, "YMR135WA_YLR465C")
    push!(res, "YCR018C_YNL337W")
    push!(res, "YNL336W_YER189W")
    push!(res, "YCR039C_YKL178C")
    push!(res, "YPL248C_YLR463C")
    push!(res, "YCL065W_YNL337W")
    push!(res, "YOR140W_YCR040W")
    push!(res, "YGL035C_YMR135WA")
    push!(res, "YHR091C_YPR199C")
    push!(res, "YCR040W_YDR421W")
    push!(res, "YNL336W_YGR296W")
    push!(res, "YCR097W_YPL248C")
    push!(res, "YNL336W_YGL209W")
    push!(res, "YGR296W_YKL109W")
    push!(res, "YHR091C_YML113W")
    push!(res, "YGR296W_YCR040W")
    push!(res, "YMR280C_YLR098C")
    push!(res, "YNL336W_YCR018C")
    push!(res, "YGL001C_YCL066W")
    push!(res, "YLR098C_YHR006W")
    push!(res, "YGL001C_YCR097W")
    push!(res, "YLR467W_YGL001C")
    push!(res, "YLR013W_YHR091C")
    push!(res, "YOL089C_YKL178C")
    push!(res, "YOR032C_YPL283C")
    push!(res, "YLR013W_YPL248C")
    push!(res, "YCR040W_YDR146C")
    push!(res, "YOL089C_YLR465C")
    push!(res, "YNL336W_YLR465C")
    push!(res, "YDR421W_YPL283C")
    push!(res, "YCR040W_YCL065W")
    push!(res, "YBR020W_YPR199C")
    push!(res, "YLR013W_YGR044C")
    push!(res, "YLR467W_YER188CA")
    push!(res, "YER188CA_YLR467W")
    push!(res, "YDR146C_YMR135WA")
    push!(res, "YML113W_YDR146C")
    push!(res, "YPL283C_YGR296W")
    push!(res, "YCL066W_YGR296W")
    push!(res, "YBL111C_YLR465C")

    
    res
end

function get_universe_set(inputs::Any)
    res = Set()
    for i in inputs
        for j in inputs
            re = i * "_" * j
            push!(res, re)
        end
    end
    res
end

"
(TP + TN) / (TP + FP + FN + TN)

TP (true positive) correctly predicted connections
FP (false positive) incorrectly predicted connections
FN (false negative) non-inferred connections
TN (true negative) correct negative predictions

"
function get_structural_accuracy(expect::Set, actual::Set, universe::Set)
    TP = length(intersect(actual, expect))
    FP = length(setdiff(actual, expect))
    FN = length(setdiff(expect, actual))
    expect_negative = setdiff(universe, expect)
    actual_negative = setdiff(universe, actual)
    TN = length(intersect(actual_negative, expect_negative))

    acc = (TP + TN) / (TP + FP + FN + TN)
    println("TP : $(TP)")
    println("FP : $(FP)")
    println("FN : $(FN)")
    println("TN : $(TN)")
    println("Structural accuracy : $(acc)")

    acc
end

df_origin = DataFrame(CSV.File("data/Yeast50_bool.tsv",drop=["Time"],type=Int))

universe = get_universe_set(names(df_origin))

expect = get_expect()

actual = get_actual()

stru_acc = get_structural_accuracy(expect, actual, universe)

dc = dynamic_consistency(df_origin, actual)

println("Calculated dynamic accuracy: $(dc)")